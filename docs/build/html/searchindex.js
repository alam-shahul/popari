Search.setIndex({docnames:["index","modules","spicemix"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":3,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":2,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["index.rst","modules.rst","spicemix.rst"],objects:{"":{spicemix:[2,0,0,"-"]},"spicemix.analysis":{compute_ari_scores:[2,1,1,""],leiden:[2,1,1,""],multireplicate_heatmap:[2,1,1,""],plot_all_metagene_embeddings:[2,1,1,""],plot_ari_scores:[2,1,1,""],plot_in_situ:[2,1,1,""],plot_metagene_embedding:[2,1,1,""]},"spicemix.components":{EmbeddingOptimizer:[2,2,1,""],EmbeddingState:[2,2,1,""],MetageneState:[2,2,1,""],ParameterOptimizer:[2,2,1,""],SpatialAffinityState:[2,2,1,""],SpiceMixDataset:[2,2,1,""]},"spicemix.components.EmbeddingOptimizer":{estimate_weight_wnbr:[2,3,1,""],estimate_weight_wonbr:[2,3,1,""],link:[2,3,1,""],update_embeddings:[2,3,1,""]},"spicemix.components.EmbeddingState":{K:[2,4,1,""],normalize:[2,3,1,""]},"spicemix.components.MetageneState":{context:[2,4,1,""],datasets:[2,4,1,""],metagenes:[2,4,1,""],reaverage:[2,3,1,""]},"spicemix.components.ParameterOptimizer":{estimate_M:[2,3,1,""],estimate_Sigma_x_inv:[2,3,1,""],link:[2,3,1,""],scale_metagenes:[2,3,1,""],update_metagenes:[2,3,1,""],update_sigma_yx:[2,3,1,""],update_spatial_affinity:[2,3,1,""]},"spicemix.components.SpatialAffinityState":{initialize:[2,3,1,""],reaverage:[2,3,1,""]},"spicemix.components.SpiceMixDataset":{compute_spatial_neighbors:[2,3,1,""],plot_metagene_embedding:[2,3,1,""],remove_connectivity_artifacts:[2,3,1,""]},"spicemix.initialization":{initialize_kmeans:[2,1,1,""],initialize_svd:[2,1,1,""]},"spicemix.io":{convert_numpy_to_pytorch_sparse_coo:[2,1,1,""],load_anndata:[2,1,1,""],make_hdf5_compatible:[2,1,1,""],save_anndata:[2,1,1,""]},"spicemix.model":{SpiceMixPlus:[2,2,1,""],load_trained_model:[2,1,1,""]},"spicemix.model.SpiceMixPlus":{K:[2,4,1,""],datasets:[2,4,1,""],embedding_optimizer:[2,4,1,""],estimate_parameters:[2,3,1,""],estimate_weights:[2,3,1,""],load_anndata_datasets:[2,3,1,""],load_dataset:[2,3,1,""],parameter_optimizer:[2,4,1,""],save_results:[2,3,1,""],synchronize_datasets:[2,3,1,""]},"spicemix.sample_for_integral":{integrate_of_exponential_over_simplex:[2,1,1,""],project2simplex:[2,1,1,""],test_project2simplex:[2,1,1,""],test_project2simplex_basic:[2,1,1,""]},"spicemix.synthesize":{SyntheticDataset:[2,2,1,""],generate_affinity_matrix:[2,1,1,""],multivariate_normal:[2,1,1,""],perturb_genes:[2,1,1,""],sample_2D_points:[2,1,1,""],sample_gaussian:[2,1,1,""],sample_truncated_gaussian:[2,1,1,""],synthesize_cell_embeddings:[2,1,1,""],synthesize_metagenes:[2,1,1,""]},"spicemix.synthesize.SyntheticDataset":{initialize_data_directory:[2,3,1,""],plot_cell_types:[2,3,1,""],plot_cells_UMAP:[2,3,1,""],plot_hidden_states:[2,3,1,""],plot_metagenes:[2,3,1,""],plot_metagenes_in_situ:[2,3,1,""]},"spicemix.util":{IndependentSet:[2,2,1,""],NesterovGD:[2,2,1,""],a2i:[2,1,1,""],array2string:[2,1,1,""],calc_modularity:[2,1,1,""],clustering_louvain:[2,1,1,""],clustering_louvain_nclust:[2,1,1,""],encode4h5:[2,1,1,""],evaluate_embedding:[2,1,1,""],evaluate_prediction:[2,1,1,""],evaluate_prediction_wrapper:[2,1,1,""],getRank:[2,1,1,""],get_datetime:[2,1,1,""],openH5File:[2,1,1,""],parseIiter:[2,1,1,""],parse_suffix:[2,1,1,""],print_datetime:[2,1,1,""],project2simplex:[2,1,1,""],project_M:[2,1,1,""],unzipTensors:[2,1,1,""],zipTensors:[2,1,1,""]},"spicemix.util.IndependentSet":{N:[2,4,1,""],adjacency_list:[2,4,1,""],batch_size:[2,4,1,""]},"spicemix.util.NesterovGD":{parameters:[2,4,1,""],set_parameters:[2,3,1,""],step:[2,3,1,""],step_size:[2,4,1,""]},spicemix:{analysis:[2,0,0,"-"],components:[2,0,0,"-"],initialization:[2,0,0,"-"],io:[2,0,0,"-"],model:[2,0,0,"-"],sample_for_integral:[2,0,0,"-"],simulation_framework:[2,0,0,"-"],synthesize:[2,0,0,"-"],util:[2,0,0,"-"]}},objnames:{"0":["py","module","Python module"],"1":["py","function","Python function"],"2":["py","class","Python class"],"3":["py","method","Python method"],"4":["py","attribute","Python attribute"]},objtypes:{"0":"py:module","1":"py:function","2":"py:class","3":"py:method","4":"py:attribute"},terms:{"0001":2,"100":2,"1000":2,"10000":2,"1101":2,"13952002":2,"1991":2,"2001":2,"2013":2,"20188431":2,"2402504":2,"2nd":2,"3rd":2,"5000":2,"6081":2,"\u03bb_m":2,"\u03bb_sigma_x_inv":2,"\u03c3":2,"\u03c3_yx":2,"\u03c3x":2,"class":2,"default":2,"float":2,"function":2,"import":2,"int":2,"new":2,"return":2,"static":2,"true":2,"try":2,Axes:2,For:2,Not:2,Such:2,The:2,These:2,_ax:2,_core:2,a2i:2,abov:2,acceler:2,acceleratedgradientdesc:2,accord:2,account:2,across:2,add:2,addit:2,adjac:2,adjacency_list:2,adjacency_matrix:2,affin:2,all:2,allow:2,along:2,analog:2,analysi:1,anndata:2,annot:2,apart:2,approxim:2,ari:2,ari_kei:2,around:2,arr:2,arrai:2,arrang:2,array2str:2,array_lik:2,arxiv:2,aspect:2,averag:2,axes:2,axi:2,backend_algorithm:2,background_sigma_x:2,backward:2,base:2,batch_siz:2,becaus:2,befor:2,behavior:2,being:2,bell:2,below:2,beta:2,biolog:2,blog:2,bool:2,brain:2,built:2,calc_modular:2,can:2,cast:2,cell:2,cell_typ:2,cell_type_definit:2,center:2,cheap:2,check:2,check_valid:2,clamp:2,classif:2,classifi:2,cluster:2,clustering_louvain:2,clustering_louvain_nclust:2,code:2,collect:2,color:2,column:2,column_nam:2,com:2,compar:2,compat:2,compon:1,comput:2,compute_ari_scor:2,compute_spatial_neighbor:2,constitu:2,constraint:2,contain:2,content:1,context:2,convert:2,convert_numpy_to_pytorch_sparse_coo:2,coo_tensor:2,coordin:2,coordinates_kei:2,correctli:2,cortex:2,cov:2,covari:2,covariance_matrix:2,creat:2,current:2,curv:2,data:2,dataset:2,dataset_path:2,default_rng:2,defin:2,definit:2,delaunai:2,densiti:2,descent:2,detail:2,deviat:2,df_meta:2,diag:2,diagon:2,dict:2,differ:2,differenti:2,dim:2,dimens:2,dimension:2,directli:2,directori:2,display_fn:2,distanc:2,distribut:2,do_plot:2,do_sil:2,doubl:2,downstream:2,draw:2,drawn:2,dropout_prob:2,duda:2,durat:2,dure:2,each:2,edu:2,element:2,embed:2,embedding_kei:2,embedding_optim:2,embeddingoptim:2,embeddingst:2,encod:2,encode4h5:2,entri:2,epoch:2,eps:2,equal:2,equival:2,estim:2,estimate_m:2,estimate_paramet:1,estimate_sigma_x_inv:2,estimate_weight:1,estimate_weight_wnbr:2,estimate_weight_wonbr:2,eta:2,evaluate_embed:2,evaluate_predict:2,evaluate_prediction_wrapp:2,everi:2,exactli:2,exampl:2,express:2,facilit:2,fals:2,field:2,file:2,filenam:2,filepath:2,find:2,first:2,first_threshold:2,follow:2,follw:2,format:2,formul:2,four:2,fov:2,fraction:2,from:2,full:2,gamma:2,gaussian:2,gene:2,gene_express:2,gener:2,generate_affinity_matrix:2,geometr:2,get_datetim:2,getrank:2,given:2,goal:2,grad:2,grad_i:2,gradient:2,graph:2,group:2,guarante:2,h5ad:2,hart:2,has:2,have:2,hdf5:2,heatmap_kwarg:2,help:2,hidden:2,higher:2,hill:2,hmrf:2,how:2,http:2,ident:2,ignor:2,iiter:2,imabandit:2,implement:2,includ:2,independ:2,independentset:2,index:0,indic:2,inform:2,initi:1,initial_context:2,initial_embed:2,initialization_method:2,initialize_data_directori:2,initialize_kmean:2,initialize_svd:2,input:2,instanc:2,instanti:2,instead:2,integrate_of_exponential_over_simplex:2,interact:2,invers:2,iter:2,ith:2,its:2,kei:2,key_pr:2,key_repli:2,key_truth:2,kmean:2,kwarg:2,kwargs_clust:2,kwargs_kmean:2,kwargs_neighbor:2,label:2,lam:2,lambda_m:2,lambda_sigma_bar:2,lambda_sigma_x_inv:2,latent:2,latent_spac:2,learn:2,least:2,leiden:2,length:2,level:2,lie:2,like:2,link:2,list:2,load:2,load_anndata:2,load_anndata_dataset:2,load_dataset:2,load_trained_model:2,locat:2,lookup:2,louvain:2,m_bar:2,m_constraint:2,m_nonneg:2,mai:2,main:1,maintain:2,make:2,make_hdf5_compat:2,map:2,mask_condit:2,match:2,math:2,matplotlib:2,matrix:2,max:2,mcgraw:2,mean:2,metagen:2,metagene_index:2,metagene_mod:2,metagene_st:2,metagene_variation_prob:2,metagenest:2,method:2,min:2,minimum_dist:2,mode:2,model:1,modul:[0,1],most:2,mous:2,multimod:2,multinorm:2,multipl:2,multireplicate_heatmap:2,multivari:2,multivariate_norm:2,must:2,n_clust_target:2,n_epoch:2,n_noise_metagen:2,naiv:2,name:2,ndarrai:2,need:2,neg:2,neighbor:2,nesterov:2,nesterovgd:2,newton:2,nmf:2,node:2,noise_metagene_paramet:2,non:2,none:2,nonneg:2,normal:2,normalized_kei:2,normalized_x:2,note:2,num_attempt:2,num_cel:2,num_gen:2,num_metagen:2,num_point:2,num_r:2,num_real_metagen:2,num_step:2,num_walk:2,number:2,numer:2,numpi:2,numpy_coo:2,obj:2,object:2,obs:2,obsm:2,obsp:2,onc:2,one:2,onli:2,onto:2,openh5fil:2,optim:2,option:2,order:2,order_gen:2,org:2,orient:2,original_metagen:2,orthogon:2,other:2,otherwis:2,out:2,output:2,pack:2,packag:1,page:0,pair:2,papouli:2,paramet:2,parameter:2,parameter_optim:2,parameteroptim:2,parent_directori:2,parse_suffix:2,parseiit:2,pass:2,path2dataset:2,path:2,pathlib:2,pattern:2,pdf:2,peak:2,per:2,permut:2,perturb:2,perturb_gen:2,pleas:2,plot:2,plot_all_metagene_embed:2,plot_ari_scor:2,plot_cell_typ:2,plot_cells_umap:2,plot_hidden_st:2,plot_in_situ:2,plot_metagen:2,plot_metagene_embed:2,plot_metagenes_in_situ:2,plt:2,point:2,popular:2,posit:2,precomput:2,predict:2,preprocess:2,pretrain:2,previou:2,princeton:2,print:2,print_datetim:2,prior_x:2,prior_x_mod:2,probabl:2,process:2,project2simplex:2,project:2,project_m:2,proper:2,properti:2,provid:2,purpos:2,pyplot:2,pytorch:2,question:2,quick:2,rais:2,random:2,random_st:2,randomli:2,real_metagene_paramet:2,reaverag:2,refer:2,reformat:2,relat:2,reload:2,remove_connectivity_artifact:2,repli:2,replic:2,replicate_mask:2,replicate_nam:2,replicate_vari:2,repres:2,reset:2,resolut:2,resolution_boundari:2,resolution_init:2,resolution_upd:2,respect:2,roughli:2,row:2,s_i:2,sampl:2,sample_2d_point:2,sample_for_integr:1,sample_gaussian:2,sample_truncated_gaussian:2,save:2,save_anndata:2,save_figur:2,save_result:2,scalar:2,scale:2,scale_metagen:2,scatterplot_kwarg:2,scheme:2,search:0,second_threshold:2,see:2,seen:2,semi:2,semidefinit:2,separ:2,sequenc:2,set:2,set_paramet:2,shape:2,share:2,shared_metagen:2,should:2,show:2,sigma:2,sigma_x_inv:2,sigma_x_inv_bar:2,sigma_x_scal:2,sigma_yx:2,sigma_yx_inv_mod:2,signal_sigma_x:2,simpl:2,simplex:2,simulation_framework:1,singl:2,singular:2,situ:2,size:2,slightli:2,some:2,sort:2,sourc:2,space:2,spars:2,sparse_adjacency_matrix:2,sparse_distance_matrix:2,spatial:2,spatial_affinity_mod:2,spatial_affinity_regularization_pow:2,spatial_affinity_sc:2,spatialaffinityst:2,specifi:2,spheric:2,spicemixdataset:2,spicemixplu:2,spread:2,squar:2,stabil:2,stackexchang:2,stackoverflow:2,standard:2,start:2,state:2,step:2,step_siz:2,stochast:2,store:2,stork:2,str:2,structur:2,submodul:1,sum_:2,support:2,sure:2,svd:2,symmetr:2,synchron:2,synchronize_dataset:2,synthes:1,synthesize_cell_embed:2,synthesize_metagen:2,synthet:2,syntheticdataset:2,system:2,take:2,task:2,tau:2,tensor:2,term:2,test_project2simplex:2,test_project2simplex_bas:2,theoret:2,thi:2,thr:2,threshold:2,todo:2,togeth:2,tol:2,toler:2,torch:2,torch_context:2,trained_model:2,transcriptom:2,treat:2,triangul:2,truncat:2,tupl:2,twice:2,two:2,type:2,umap:2,undefin:2,union:2,unit:2,univari:2,uns:2,unziptensor:2,updat:2,update_alg:2,update_embed:2,update_metagen:2,update_sigma_yx:2,update_spatial_affin:2,urgent:2,use:2,use_neighbor:2,use_rep:2,used:2,user:2,uses:2,using:2,util:1,valu:2,vanilla:2,vari:2,variabl:2,varianc:2,vector:2,verbos:2,view:2,visual:2,wai:2,warn:2,weight:2,well:2,when:2,where:2,which:2,width:2,wilei:2,without:2,word:2,work:2,wrap:2,wrapper:2,x_1:2,x_2:2,x_i:2,x_j:2,x_n:2,x_nonneg:2,yield:2,york:2,zero:2,zero_threshold:2,ziptensor:2,zit:2},titles:["Welcome to SpiceMixPlus\u2019s documentation!","spicemix","spicemix package"],titleterms:{analysi:2,compon:2,content:2,document:0,estimate_paramet:2,estimate_weight:2,indic:0,initi:2,main:2,model:2,modul:2,packag:2,sample_for_integr:2,simulation_framework:2,spicemix:[1,2],spicemixplu:0,submodul:2,synthes:2,tabl:0,util:2,welcom:0}})